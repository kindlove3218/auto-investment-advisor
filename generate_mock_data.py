"""
生成模拟市场数据用于测试
"""

import json
import os
from datetime import datetime


def generate_mock_data():
    """生成模拟的市场数据"""
    
    mock_data = {
        'timestamp': datetime.now().isoformat(),
        'cn': {
            'timestamp': datetime.now().isoformat(),
            'market': 'cn',
            'hot_stocks': {
                'top_gainers': [
                    {'代码': '600000', '名称': '浦发银行', '涨跌幅': 5.0, '价格': 10.50, '成交量': 100000000},
                    {'代码': '600036', '名称': '招商银行', '涨跌幅': 4.5, '价格': 32.80, '成交量': 95000000},
                    {'代码': '000001', '名称': '平安银行', '涨跌幅': 4.2, '价格': 12.30, '成交量': 88000000},
                    {'代码': '601318', '名称': '中国平安', '涨跌幅': 3.8, '价格': 45.20, '成交量': 75000000},
                    {'代码': '601328', '名称': '交通银行', '涨跌幅': 3.5, '价格': 5.80, '成交量': 68000000},
                ],
                'top_losers': [
                    {'代码': '000002', '名称': '万科A', '涨跌幅': -4.5, '价格': 8.20, '成交量': 120000000},
                    {'代码': '000858', '名称': '五粮液', '涨跌幅': -3.8, '价格': 135.50, '成交量': 45000000},
                ],
                'top_volume': [
                    {'代码': '600519', '名称': '贵州茅台', '涨跌幅': 2.5, '价格': 1680.00, '成交量': 150000000},
                    {'代码': '000858', '名称': '五粮液', '涨跌幅': -3.8, '价格': 135.50, '成交量': 45000000},
                ]
            },
            'hot_sectors': [
                {'板块名称': '银行', '涨跌幅': 4.2, '最新价': 10.50, '上涨家数': 25, '下跌家数': 2},
                {'板块名称': '保险', '涨跌幅': 3.5, '最新价': 45.20, '上涨家数': 8, '下跌家数': 1},
                {'板块名称': '证券', '涨跌幅': 2.8, '最新价': 12.30, '上涨家数': 30, '下跌家数': 5},
            ],
            'stocks_to_analyze': [
                {'代码': '600000', '名称': '浦发银行', '涨跌幅': 5.0, '价格': 10.50},
                {'代码': '600036', '名称': '招商银行', '涨跌幅': 4.5, '价格': 32.80},
                {'代码': '000001', '名称': '平安银行', '涨跌幅': 4.2, '价格': 12.30},
                {'代码': '601318', '名称': '中国平安', '涨跌幅': 3.8, '价格': 45.20},
                {'代码': '601328', '名称': '交通银行', '涨跌幅': 3.5, '价格': 5.80},
            ]
        },
        'hk': {
            'timestamp': datetime.now().isoformat(),
            'market': 'hk',
            'hot_stocks': {
                'top_gainers': [
                    {'代码': '00700', '名称': '腾讯控股', '涨跌幅': 3.5, '价格': 320.00, '成交量': 20000000},
                    {'代码': '00941', '名称': '中国移动', '涨跌幅': 2.8, '价格': 68.50, '成交量': 15000000},
                    {'代码': '01299', '名称': '友邦保险', '涨跌幅': 2.5, '价格': 85.20, '成交量': 8000000},
                ],
                'top_losers': [
                    {'代码': '03690', '名称': '美团', '涨跌幅': -4.2, '价格': 78.50, '成交量': 25000000},
                ],
                'top_volume': [
                    {'代码': '00700', '名称': '腾讯控股', '涨跌幅': 3.5, '价格': 320.00, '成交量': 20000000},
                    {'代码': '03690', '名称': '美团', '涨跌幅': -4.2, '价格': 78.50, '成交量': 25000000},
                ]
            },
            'stocks_to_analyze': [
                {'代码': '00700', '名称': '腾讯控股', '涨跌幅': 3.5, '价格': 320.00},
                {'代码': '00941', '名称': '中国移动', '涨跌幅': 2.8, '价格': 68.50},
                {'代码': '01299', '名称': '友邦保险', '涨跌幅': 2.5, '价格': 85.20},
            ]
        },
        'us': {
            'timestamp': datetime.now().isoformat(),
            'market': 'us',
            'hot_stocks': [
                {'代码': 'AAPL', '名称': 'Apple Inc.', '价格': 185.50, '涨跌幅': 2.3, '成交量': 50000000},
                {'代码': 'MSFT', '名称': 'Microsoft Corp.', '价格': 380.20, '涨跌幅': 1.8, '成交量': 25000000},
                {'代码': 'GOOGL', '名称': 'Alphabet Inc.', '价格': 140.80, '涨跌幅': 1.5, '成交量': 30000000},
                {'代码': 'AMZN', '名称': 'Amazon.com', '价格': 155.30, '涨跌幅': 2.0, '成交量': 40000000},
                {'代码': 'NVDA', '名称': 'NVIDIA Corp.', '价格': 480.50, '涨跌幅': 3.2, '成交量': 35000000},
            ],
            'sector_performance': [
                {'板块': 'Technology', '涨跌幅': 2.5},
                {'板块': 'Financial', '涨跌幅': 1.2},
                {'板块': 'Healthcare', '涨跌幅': 0.8},
                {'板块': 'Consumer', '涨跌幅': 1.5},
            ],
            'stocks_to_analyze': [
                {'代码': 'AAPL', '名称': 'Apple Inc.', '价格': 185.50, '涨跌幅': 2.3},
                {'代码': 'MSFT', '名称': 'Microsoft Corp.', '价格': 380.20, '涨跌幅': 1.8},
                {'代码': 'GOOGL', '名称': 'Alphabet Inc.', '价格': 140.80, '涨跌幅': 1.5},
            ]
        }
    }
    
    return mock_data


def save_mock_data(data, filename=None):
    """保存模拟数据"""
    os.makedirs('data', exist_ok=True)
    
    if not filename:
        filename = f"market_data_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    
    filepath = os.path.join('data', filename)
    
    with open(filepath, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print(f"模拟数据已保存: {filepath}")
    return filepath


if __name__ == "__main__":
    print("生成模拟市场数据...")
    mock_data = generate_mock_data()
    filepath = save_mock_data(mock_data)
    print(f"\n数据概览:")
    print(f"- A股待分析: {len(mock_data['cn']['stocks_to_analyze'])} 只")
    print(f"- 港股待分析: {len(mock_data['hk']['stocks_to_analyze'])} 只")
    print(f"- 美股待分析: {len(mock_data['us']['stocks_to_analyze'])} 只")
    print(f"\n现在可以使用以下命令测试分析:")
    print(f"python analyze_stocks.py {filepath}")
